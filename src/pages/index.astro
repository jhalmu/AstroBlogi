---
import Layout from '../layouts/Layout.astro'
import Hero from '../components/Hero.astro'
import BlogCard from '../components/BlogCard.astro'
import { getCollection } from 'astro:content'
import type { CollectionEntry } from 'astro:content'
import { getContentPreview } from '../utils/utils.js'

const posts = (await getCollection('blog'))
	.sort(
		(a: CollectionEntry<'blog'>, b: CollectionEntry<'blog'>) =>
			new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf()
	)
	.slice(0, 2)

const title = "Juha Halmu's Blog"
const description = 'Technology, Photography, and Local History'
---

<Layout title={title} description={description}>
	<main class='text-center'>
		<Hero />

		<section class='bg-transparent-400 mt-2 rounded-2xl py-10'>
			<div class='container mx-auto px-2'>
				<div class='grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-2'>
					{
						posts.map((post) => {
							const postDescription = post.data.description || getContentPreview(post.body)
							return (
								<BlogCard
									title={post.data.title}
									pubDate={post.data.pubDate}
									slug={post.id}
									lang={post.data.lang}
									description={postDescription}
									tags={post.data.tags}
								/>
							)
						})
					}
				</div>
			</div>
		</section>
	</main>
</Layout>

<style>
	@media (max-width: 640px) {
		article {
			padding: 0 0.5rem;
		}
	}
</style>
